---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "plumber_relay Resource - terraform-provider-plumber"
subcategory: ""
description: |-
  Relay messages to your Batch.sh collections
---

# Resource: plumber_relay

A relay allows you to relay messages from a configured connection to your Batch.sh collections

Use this resource to read/update/delete a relay

## Example Usage 

---

```hcl
# Create connection
resource "plumber_connection" "local_kafka" {
  name = "my local kafka"
  kafka {
    address = ["localhost:9092"]
    connection_timeout = 5
  }
}

resource "plumber_relay" "kafka_relay" {
  connection_id = plumber_connection.local_kafka.id
  
  collection_token = "19bd1e44-d685-4945-8b27-7cae2e1fa533"

  # Need at least one message bus config
  kafka {
    topics = ["tfrelaytest"]
    consumer_group_name = "plumber"
    use_consumer_group = true
  }
}
```

## Argument Reference

---

### Required

- `collection_token` - (String) - Collection Token
- `connection_id` - (String) - Plumber connection ID
- `active` - Whether the tunnel is active.

At least one message bus relay configuration must be specified:

- `kafka` - (Block List, Max: 1) (see [below for nested schema](#nestedblock--kafka))
- `rabbit` - (Block List, Max: 1) (see [below for nested schema](#nestedblock--rabbit))

### Optional

- `batch_max_retry` - (Number) - How many times plumber will try re-sending a batch (Default: `3`)
- `batch_size` - (Number) - How many messages to send in a single batch (Default: `1000`)
- `num_workers` - (Number) - How many workers to launch per relay (Default: `10`)
- `stats_enable` - (Boolean) - Display periodic relay stats
- `stats_report_interval_sec` - (Number) - How often to print stats (Default: `10`)


<a id="nestedblock--kafka"></a>
### Nested Schema for `kafka`

Required:

- `topics` - (List of String) - Kafka topics to read from

Optional:

- `commit_interval_seconds` - (Number) - How often, in seconds, to commit offsets to broker (0 = synchronous) (Default: `5`)
- `consumer_group_name` - (String) - Specify a specific group-id to use when reading from kafka
- `max_bytes` - (Number) - Maximum number of bytes to fetch in a single kafka request (throughput optimization) (Default: `1`)
- `max_wait_seconds` - (Number) - How long to wait for new data when reading batches of messages (Default: `1`)
- `min_bytes` - (Number) - Minimum number of bytes to fetch in a single kafka request (throughput optimization) (Default: `1`)
- `queue_capacity` - (Number) - Internal library queue capacity (throughput optimization) (Default: `1`)
- `read_offset` - (Number) - Specify what offset the consumer should read from (Requires use_consumer_group to be true) (Default: `0`)
- `rebalance_timeout_seconds` - (Number) - How long a coordinator will wait for member joins as part of a rebalance (Default: `0`)
- `use_consumer_group` - (Boolean) -  Use a consumer group to read from Kafka

<a id="nestedblock--rabbit"></a>
### Nested Schema for `rabbit`

Required:

- `exchange_name` - (String) - Name of the exchange
- `queue_name` - (String) - Name of the queue where messages will be routed to
- `binding_key` - (String) - Binding key for topic based exchanges

Optional:

- `queue_exclusive` - (Boolean) - Name of the exchange
- `queue_declare` - (Boolean) - Whether to create/declare the queue (if it does not exist)
- `queue_durable` - (Boolean) - Whether plumber should be the only one using the queue
- `auto_ack` - (Boolean) - Automatically acknowledge receipt of read/received messages
- `consumer_tag` - (String) - How to identify the consumer to RabbitMQ
- `queue_delete` - (Boolean) - Whether to auto-delete the queue after plumber has disconnected
- `queue_arg` - (Map of String) -  Additional queue argument to send to RabbitMQ

## Attributes Reference

---

In addition to all arguments above, the following attributes are returned:

- `id` - (String) - Relay ID

## Import

---

You can import an existing dynamic replay configuration from plumber by specifying its ID:

```bash
$ terraform import plumber_relay.local_kafka d743952d-6dc4-472b-849f-44015c8af3fb
```
